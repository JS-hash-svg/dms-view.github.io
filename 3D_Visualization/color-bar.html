<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Learning to use color legend from d3.legend</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="colorbrewer.min.js"></script>
</head>

<body>
  <script>
    var yellow = d3.interpolateYlGn(0), // "rgb(255, 255, 229)"
      yellowGreen = d3.interpolateYlGn(0.5), // "rgb(120, 197, 120)"
      green = d3.interpolateYlGn(1); // "rgb(0, 69, 41)"
    var t = [0, .1, .2, .3, .4, .5, .6, .7, .8, .9, 1]
    var width = 500
    console.log(d3.extent(t))

    var countScale = d3.scaleLinear()
      .domain(d3.extent(t))
      .range([0, width]);

    var colorScale = d3.scaleLinear()
      .domain([0, d3.extent(t)[1] / 2, d3.extent(t)[1]])
      .range(d3.schemeReds[3]);

    var xScale = d3.scaleLinear()
      .domain(d3.extent(t))
      .range([-width, width]);

    var svg = d3.select("body").append("svg")
      .attr("width", 500)
      .attr("height", 300);

    var defs = svg.append("defs");

    var gradient = defs.append("linearGradient")
      .attr("id", "svgGradient")
      .attr("x1", "0%")
      .attr("x2", "100%")
      .attr("y1", "0%")
      .attr("y2", "0%");

    var numStops = 10;

    var countRange = countScale.domain();
    // index 2 is the substraction between max and min
    countRange[2] = countRange[1] - countRange[0];
    var countPoint = [];
    for (var i = 0; i < numStops; i++) {
      countPoint.push(i * countRange[2] / (numStops - 1) + countRange[0]);
    }
    // create a color key based on the bar and attach it to a list to use a reference 
    var colorKey = []
    for (var i = 0; i < numStops; i++) {
      countPoint.push(i * countRange[2] / (numStops - 1) + countRange[0]);
    }
    gradient.selectAll("stop")
      .data(d3.range(numStops))
      .enter()
      .append("stop")
      .attr('class', 'start')
      .attr("offset", function(d, i) {
        return countScale(countPoint[i]) / width;
      })
      .attr("stop-color", function(d, i) {
        return colorScale(countPoint[i]);
      });

    svg.append("rect")
      .attr("class", "legendRect")
      .attr("x", 10)
      .attr("y", 35)
      .attr("width", 400)
      .attr("height", 25)
      .style("fill", "url(#svgGradient)");

  </script>
</body>

</html>
